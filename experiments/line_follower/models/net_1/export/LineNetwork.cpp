#include <LineNetwork.h>
#include <Linear.h>
#include <Conv1d.h>
#include <Conv2d.h>
#include <ReLU.h>
#include <GlobalAveragePooling.h>


const int8_t LineNetwork_layer_0_weights[] = {
127, 54, -1, -58, 51, -25, -51, -45, -10, 
16, 67, -32, 52, 0, 13, -23, -71, -74, 
20, -111, 24, 77, -62, -30, 125, -15, 35, 
58, 59, 48, 82, 9, -13, 1, -39, -50, 
-54, 53, 63, -9, 9, -41, 0, 27, -49, 
-85, 69, 56, -76, 86, -13, -82, 127, -47, 
-31, 63, -1, -5, -69, 60, 28, -127, -18, 
-10, 57, 68, 50, -1, -84, 5, -62, -127, 
};

const int8_t LineNetwork_layer_0_bias[] = {
-25, 86, -33, 76, 74, -45, -31, -37, };


const int8_t LineNetwork_layer_2_weights[] = {
-21, 82, 85, 34, 46, 53, 63, 3, 
-19, 10, 16, -34, 40, -116, 38, -51, 
-14, -58, -60, 14, -26, 45, 88, 37, 
-43, 25, -71, 33, 35, -81, 68, 99, 
-30, -3, 33, -11, 83, 40, 17, 18, 
47, 27, -6, 53, 59, -14, 48, 16, 
-28, 7, 92, 14, 80, 50, 38, 127, 
90, -26, 113, 5, -13, 38, 63, 122, 
40, 19, 83, 101, 52, 47, 23, -41, 
-35, 114, -13, 59, 20, 9, 103, 58, 
40, 18, -19, 71, 42, 1, 105, -18, 
52, 31, 33, -8, -13, 39, 127, 63, 
22, 14, -36, 26, 84, -10, 127, 115, 
97, 65, 115, 53, 82, 5, 25, -4, 
-52, -17, 81, 40, 7, 46, 85, 57, 
8, 14, 106, 50, 127, 127, 127, -9, 
22, 20, 70, 93, 100, -9, 10, -127, 
24, -69, -27, -3, 83, -35, 80, 57, 
-40, -54, -57, 45, -22, -38, 21, -127, 
67, 18, -12, 55, 40, 9, -34, 17, 
7, 74, 55, -13, -9, 34, 36, 7, 
-19, 12, -110, 17, 4, 87, -25, -80, 
4, -30, -43, 12, -101, 118, 127, 127, 
108, 7, 50, -13, 45, -23, 13, 20, 
-12, -35, 23, 2, 19, 11, -66, -63, 
-12, 6, 18, 10, -101, 68, 78, 127, 
67, 38, 127, 31, 21, 55, 20, -9, 
66, 23, 7, -44, -1, 49, 65, -47, 
-122, 19, -5, 49, -6, 31, 11, -60, 
-98, 74, -127, -17, 4, -127, -10, -127, 
87, 28, 11, -53, 28, 13, -16, 15, 
8, 0, 33, 89, 12, -13, 21, -13, 
-75, 29, -127, 36, 39, -127, -23, -91, 
65, 13, 4, -32, -21, -70, -33, 27, 
60, -24, 29, 59, -4, 7, 4, 5, 
-75, -28, -83, 36, 3, -127, -89, -63, 
53, 93, 84, 54, 13, 64, 80, 127, 
96, 29, 2, -50, 93, 10, 43, 107, 
11, 66, 127, 13, 85, -48, -13, -127, 
-73, -56, 44, 55, 1, 48, 110, 54, 
14, 42, 55, -2, 11, -4, -14, 4, 
16, 6, 79, -45, 49, -68, -49, -127, 
-16, -67, 66, 12, -2, 127, 127, 112, 
34, 8, 15, -8, 7, 74, 3, 121, 
-26, 71, 71, -13, 54, -46, -80, -127, 
75, -105, -5, 67, -17, 33, 57, 11, 
-70, 33, 125, 50, 28, 90, 121, 72, 
86, 29, 24, 71, 99, 31, 52, 85, 
66, -15, 65, 31, 16, 102, -59, 8, 
57, -37, 81, 59, 76, 7, 62, 68, 
64, 12, 85, 56, 31, 55, 78, 3, 
43, 6, 42, -39, 18, -49, -72, 77, 
113, -21, 90, 42, -47, 41, 98, 12, 
17, 14, -35, -41, 76, -111, -102, 53, 
45, -26, -104, -13, 21, -2, -86, 91, 
58, -14, 74, -21, -8, 102, 127, -73, 
4, -2, -16, -34, -39, -58, 91, -69, 
50, 79, -68, -8, -4, 25, 15, 122, 
42, 2, -52, -110, 8, 2, 87, 109, 
-127, 49, 31, 1, 12, -10, -52, 3, 
65, -21, -118, 16, 32, -11, -28, 19, 
103, 8, 98, 10, 66, 127, 127, -62, 
-27, -35, -46, 9, 12, -127, 25, -67, 
105, 59, -7, 1, 126, 78, 34, 41, 
-127, 28, 82, 13, 100, -14, -1, -50, 
21, -33, 23, -73, 27, -68, 13, -85, 
127, 23, 39, -21, 77, 14, -14, 19, 
-99, 36, -94, 14, -13, -10, -13, 14, 
-74, -127, 2, 18, -69, -23, -21, 4, 
51, 0, -66, 33, -34, -67, -113, -32, 
24, 92, -83, -13, 4, 36, -31, 52, 
-44, -51, 63, 53, -122, 22, -17, -54, 
};

const int8_t LineNetwork_layer_2_bias[] = {
-26, -7, -20, -16, -48, -13, -5, 33, };


const int8_t LineNetwork_layer_5_weights[] = {
6, 65, 40, -36, 7, -17, -19, -28, -33, -2, 109, 25, 26, 38, -127, 96, -1, -77, 82, -29, 32, -25, 81, 21, -4, -15, 97, -34, -59, -8, -89, 23, 
23, -81, 83, 19, 42, 59, 25, 48, -6, 19, 27, -33, 3, 27, 4, -4, 127, 40, -93, 91, -36, -8, -111, -36, 2, 19, 46, -41, -4, -18, -113, -96, 
7, 20, -41, 32, -13, -64, -9, 21, 0, -30, -2, 2, 72, 42, 33, 103, -17, 23, -39, -13, 50, 38, -7, 32, -55, -2, 11, 127, 121, -16, 127, 23, 
74, 87, -8, 108, -56, -82, 80, -71, -49, 32, 24, 127, 89, 67, 1, 13, -34, 36, 22, -5, 73, 27, -45, -22, -24, 10, -36, -105, -46, -35, -7, 90, 
49, 25, -29, -72, 62, 21, 97, 87, 24, -59, -1, -127, 99, -82, 125, -127, -12, 1, -2, -127, -18, 29, -49, 40, -50, -28, -123, 0, -85, 127, -78, 53, 
};

const int8_t LineNetwork_layer_5_bias[] = {
-5, -29, -45, -35, -30, };




LineNetwork::LineNetwork()
	: ModelInterface()
{
	init_buffer(128);
	total_macs = 4421;
	input_channels = 1;
	input_height = 8;
	input_width = 8;
	output_channels = 5;
	output_height = 1;
	output_width = 1;
}

void LineNetwork::forward()
{
	Conv2d<8, 8, 1, 8, 3, 2, int8_t, int8_t, int32_t>(
		output_buffer(), input_buffer(), 
		LineNetwork_layer_0_weights, LineNetwork_layer_0_bias, 59);
	swap_buffer();

	ReLU(	output_buffer(), input_buffer(), 128);
	swap_buffer();

	Conv2d<4, 4, 8, 8, 3, 2, int8_t, int8_t, int32_t>(
		output_buffer(), input_buffer(), 
		LineNetwork_layer_2_weights, LineNetwork_layer_2_bias, 68);
	swap_buffer();

	ReLU(	output_buffer(), input_buffer(), 32);
	swap_buffer();

	Linear<32, 5, int8_t, int8_t, int32_t>(
		output_buffer(), input_buffer(), LineNetwork_layer_5_weights, LineNetwork_layer_5_bias, 68);
	swap_buffer();

	swap_buffer();
}
